<html>
	<p id="readingList" style="font-size: 24px;"></p>

	<script src="2YearBibleChronological.js"></script>
	
	<script>
		const readingsToShow = 20;
		const maxExpiration = 1000; // looks like chrome will not allow more than 7 day expiration on cookie. However my browser on my phone may allow more.
		var readingLocation = -1;
		
		// create the cookie everytime we enter the page so that the expiration is reset
		createCookie("readingLocation",readCookie("readingLocation"),maxExpiration);
		readingLocation = readCookie("readingLocation"); // use the variable so that this page works locally until closed
		
		let readingList = "";
		let checkboxCreated = false;
		
		buildList();
		
		function buildList() {
			// build the list
			readingList = "";
			checkboxCreated = false;
			readings.forEach(buildListItem);		
			document.getElementById("readingList").innerHTML = readingList;
		}
		
		function buildListItem(value,index,) {
			if (index > parseInt(readingLocation) && index <= (parseInt(readingLocation) + readingsToShow)) {
				readingList += '<br>';
				if (!checkboxCreated) {
					readingList += '<input type="checkbox" id="reading' + index + '" name="reading' + index + '" value="' + value + '" onclick="checkboxClick(' + index + ')">';
					checkboxCreated = true;
				}
				readingList += '<label for="reading' + index + '">' + value + '</label>';
				readingList += '<br>';
			}
		} 
		
		function checkboxClick(value) {
			var id = "reading" + value;
			var checkbox = document.getElementById(id);
			if (!checkbox) {
				console.error(`Checkbox with id "${id}" not found`);
				return;
			}
			
			if (checkbox.checked) {
				createCookie("readingLocation",value,maxExpiration);
				readingLocation = value;
			}
			
			buildList();
		}

		function createCookie(name,value,days) {
			if (days) {
				var date = new Date();
				date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
				var expires = "; expires=" + date.toGMTString();
			} else {
				var expires = "";
			}
			document.cookie = name + "=" + value + expires + "; path=/";
		}

		function readCookie(name) {
			var nameEQ = name + "=";
			var ca = document.cookie.split(';');
			for(var i=0;i < ca.length;i++) {
				var c = ca[i];
				while (c.charAt(0)==' ') {
					c = c.substring(1,c.length);
				}
				if (c.indexOf(nameEQ) == 0) {
					return c.substring(nameEQ.length,c.length);
				}
			}
			// cluge so that this will work locally where cookies cannot be stored
			if (name=="readingLocation") {
				return -1;
			} else {
				return null;
			}	
		}

		function eraseCookie(name) {
			createCookie(name,"",-1);
		}
	</script>
</html>